<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/pyodide/v0.19.0/full/pyodide.js"></script>
    <title>Application Form</title>
</head>
<body>

    <input type="text" id="vorname" placeholder="Vorname">
    <input type="text" id="nachname" placeholder="Nachname">
    <input type="text" id="str" placeholder="StraÃŸe / Hausnummer">
    <input type="text" id="ort" placeholder="Wohnort">
    <input type="text" id="email" placeholder="E-Mail">
    <button onclick="evaluatePython()">Abschicken</button>

    <br/>
    <br/>
    <div>Output:</div>
    <textarea id="output" style="width: 100%;" rows="30" disabled></textarea>  


    
    <script type="text/javascript">
      const output = document.getElementById("output");
      const link = document.getElementById("vorname");
        
      
      function addToOutput(s) {
        // Wert in, welcher eingegeben wird, wird in der Python Consolenansicht wiedergegeben  
        output.value += ">>>" + link.value + "\n" + s + "\n";
      }

      output.value = "Initializing...\n";
      // init Pyodide
      async function main(){
        let pyodide = await loadPyodide({
          indexURL : "https://cdn.jsdelivr.net/pyodide/v0.19.0/full/"
        });

        output.value += "Ready!\n";
        return pyodide;
      }
      let pyodideReadyPromise = main();

      // execute with onClick
      async function evaluatePython() {

        let pyodide = await pyodideReadyPromise;

        try {
          // let output = pyodide.runPython(link.value);
          let output = await pyodide.runPythonAsync(`
          import js
          import json

          js.document.title = "Magerquark"
          x = 2+2*2
          y = js.vorname.value
          print(y)

          # Python program to write JSON
          # to a file
            
          # Data to be written
          data ={
              "name" : "Marc",
              "Hobbys" : "Weed Smoken",
              "Besonderheiten" : "Reitet gerne auf Einhoernern",
              "phonenumber" : "9976770500"
          }
            
          # Serializing json 
          json_object = json.dumps(data, indent = 4)
            
          # Writing to data.json
          with open('/data.json', 'wt') as outfile:
              outfile.write(json_object)



          `);
          addToOutput(output);
          let x = pyodide.runPython("open('/data.json', 'rt').read()");
          addToOutput(x);

          

        } catch (err) {
          addToOutput(err);
        }
      }
    </script>
</body>
</html>